async function submitAttendance() {
  const date = document.getElementById('attendanceDate').value;
  const presentRolls = Array.from(
    document.querySelectorAll('input[type="checkbox"]:checked')
  ).map(cb => cb.value);

  if (!date) {
    alert("Please select a date!");
    return;
  }

  try {
    const response = await fetch('YOUR_SCRIPT_URL', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ date, presentRolls })
    });
    
    const result = await response.json();
    alert(result.message);
  } catch (error) {
    alert("Error: " + error.message);
    console.error(error);
  }
}

<!DOCTYPE html>
<html>
<head>
    <title>Attendance System</title>
    <style>
        /* Your existing styles */
    </style>
</head>
<body>
    <!-- Your existing HTML -->
    <script>
        async function submitAttendance() {
            const date = document.getElementById('attendanceDate').value;
            const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
            const presentRolls = Array.from(checkboxes).map(checkbox => checkbox.value);
            
            if (!date) {
                alert("Please select a date!");
                return;
            }
            
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbwh0ERqNxd5Loh2i95vixmTyx2Y_KHHYkaC60wt2zIBlTmuw5FpEyN2wAk5yzcf__dzxQ/exec', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ date, presentRolls })
                });
                
                const result = await response.json();
                alert(result.message);
            } catch (error) {
                alert("Error: " + error.message);
                console.error(error);
            }
        }
    </script>
</body>
</html>
